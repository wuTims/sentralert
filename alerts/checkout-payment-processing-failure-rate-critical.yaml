kind: sentry.metric_alert
flow: service_analysis_agent
name: Checkout Payment Processing Failure Rate Critical
dataset: events
aggregate: failure_rate()
query: event.type:transaction transaction:"POST /api/checkout" environment:production
timeWindow: 5
thresholdType: above
environment: production
thresholds:
  warning: 2.0
  critical: 5.0
justification: Codebase shows no error handling on payment processing. Production
  analysis reveals checkout transaction with 37.2% failure rate (90 'payment token
  missing' errors + 21 'payment_method' key errors detected). This endpoint processes
  financial transactions and is completely unmonitored. External Stripe API dependency
  lacks timeout configuration.
severity: CRITICAL
actions:
- type: email
  targetType: specific
  targetIdentifier: team@example.com
proposed_by: service_analysis_agent
